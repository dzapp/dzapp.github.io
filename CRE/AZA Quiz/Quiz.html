<HTML>
<HEAD>
<TITLE>Quiz</TITLE>
<SCRIPT LANGUAGE="JavaScript" name="cmifrag">
<!--
//AICC tracking code inserted for Macromedia's Learning Components for Flash
//Copyright 2002 Macromedia, Inc. All rights reserved.
function goPage(loc){
  parent.location = loc;
}
function findcmiframe(sp) {
 if (sp==null) sp=window.parent;
 if (sp.frames.length && sp.cmiframe != null)
  return sp.cmiframe;
 else if (sp != window.top)
  return findcmiframe(sp.parent);
 else return null;
}
var aurl;
function setaurl(url) {
 tmpp=url.toUpperCase();
 if ((pos=tmpp.indexOf('AICC_URL'))>-1) {
  aurl=url.substring(pos+9,tmpp.length);
  if (aurl.indexOf('&')>0)
   aurl=aurl.substring(0,aurl.indexOf('&'));
   aurl=unescape(aurl);
   if (aurl.toUpperCase().indexOf("HTTP://") == -1)
   	aurl	= "http://" + aurl;
   return true;
  }
  return false;
}
function fndUrl(win) {
 if (setaurl(win.document.location+'') == false) {
  if (win == window.top) return false;
  return (fndUrl(win.parent));
 }
 return true;
}
if (findcmiframe(null)==null) {
 var cmi;
 if (document.command == null) {
 if (fndUrl(window)) {
 document.write("<form action="+aurl+" method=\'POST\' target=\'cmiresults\' name=\'command\'><input type=\'hidden\' name=\'command\'><input type=\'hidden\'  name=\'session_id\'><input type=\'hidden\' name=\'version\' value=\'2.0\'><input type=\'hidden\' name=\'aicc_data\'></form>");
  }}
}
//Function creates a new object for tracking
function trackObject(name, score, weight, possible) {
  this.name = name;
  this.score = score;
  this.trackWeight = weight;
  this.possibleCorrect = possible;
  this.e = 0;
}
//Create new object called G01
G01 = new trackObject("Flash Learning Object", 0, 1, 1);
//-->
</SCRIPT>
<script language="JavaScript" src="scripts/behCourseBuilder.js"></script>
<script language="JavaScript" src="scripts/cmi.js"></script>
</HEAD>
<BODY bgcolor="#999999">
<SCRIPT LANGUAGE=JavaScript>
<!--
var InternetExplorer = navigator.appName.indexOf("Microsoft") != -1;
// Handle all the the FSCommand messages in a Flash movie
function Quiz_DoFSCommand(command, args) {
  var QuizObj = InternetExplorer ? Quiz : document.Quiz;
  // CMI CHECK
  if (!window.CMIIsPresent()) {
     if (findcmiframe != null) {
        var frm = findcmiframe(null);
        if (frm != null) frm.installcmi(window);
        else if (installcmi != null) {
           installcmi(window);
           cmiinit(window);
        } 
     }
     if (window.CMIInitialize != null) window.CMIInitialize();
  }
  // PLACE CMI MAPPING FOR EACH FUNCTION HERE
  args = String(args);
  command = String(command);
  var F_intData = args.split(";");
  switch (command){
     case "MM_StartSession":
       //if no sessionid, sends user to login page where activity is set and sessionid returned
       //parameters(loginFile, activityID, activityName)
       if (!MM_SID){
             goPage(F_intData[0] + "?ActivityID=" + escape(F_intData[1]) + "&ActivityName=" + escape(F_intData[2]) + "&ReferringPage=" + escape(parent.location));
 //          parent.location = F_intData[0] + "?ActivityID=" + escape(F_intData[1]) + "&ActivityName=" + escape(F_intData[2]) + "&ReferringPage=" + parent.location;
       }
       break
     case "MM_cmiSendInteractionInfo":
       //MM_cmiSendInteractionInfo(date, time, intid, objid, intrtype, correct, student, result, weight, latency)
       G01.score = 0;
       if (F_intData[7].toUpperCase() == "C") G01.score = 1;
       G01.trackWeight = F_intData[8];
       if (F_intData[4] == "F"){
          var sTmp = F_intData[5];
          F_intData[5] = sTmp.replace(/ /gi, "_");
          sTmp = F_intData[6];
          F_intData[6] = sTmp.replace(/ /gi, "_");
       }
       MM_cmiSendInteractionInfo(F_intData[0],F_intData[1],F_intData[2],F_intData[3],F_intData[4],F_intData[5],F_intData[6],F_intData[7],F_intData[8],F_intData[9]);
       break
     case "MM_cmiSendObjectiveInfo":
       //MM_cmiSendObjectiveInfo(theInt, index, objid, score, status)
       MM_cmiSendObjectiveInfo(F_intData[0],F_intData[1],F_intData[2],F_intData[3],F_intData[4]);
       break
     case "MM_cmiSendScore":
       //MM_cmiSendScore(theInt, theScore)
       MM_cmiSendScore(F_intData[0],F_intData[1]);
       break
     case "MM_cmiSetLessonStatus":
       //MM_cmiSetLessonStatus(theStatus)
       MM_cmiSetLessonStatus(F_intData[0]);
       break
     case "CMISetTime":
       //CMISetTime(t)
       CMISetTime(F_intData[0]);
       break
     case "CMISetCompleted":
       //CMISetCompleted()
       CMISetCompleted();
       break
     case "CMISetData":
       //CMISetData(data)
       CMISetData(F_intData[0]);
       break
     case "CMISetFailed":
       //CMISetFailed() 
       CMISetFailed();
       break
     case "CMISetLocation":
       //CMISetLocation(loc)
       CMISetLocation(F_intData[0]);
       break
     case "CMISetPassed":
       //CMISetPassed()
       CMISetPassed();
       break
     case "CMISetScore":
       //CMISetScore(score)
       CMISetScore(F_intData[0]);
       break
     case "CMISetStarted":
       //CMISetStarted()
       CMISetStarted();
       break
     case "CMISetStatus":
       //CMISetStatus(stat)
       CMISetStatus(F_intData[0]);
       break
     case "CMISetTimedOut":
       //CMISetTimedOut()
       CMISetTimedOut();
       break
     case "CMIInitialize":
       //CMIInitialize()
       CMIInitialize();
       break
     case "CMIFinish":
       //MM_SVal("command","lmsfinish",1);
       break
     case "CMIExitAU":
       MM_SVal("command","exitau",1);
       break
  }
  // END OF CMI FUNCTION MAPPING
}
// Hook for Internet Explorer 
if (navigator.appName && navigator.appName.indexOf("Microsoft") != -1 && 
	  navigator.userAgent.indexOf("Windows") != -1 && navigator.userAgent.indexOf("Windows 3.1") == -1) {
	document.write('<SCRIPT LANGUAGE=VBScript\> \n');
	document.write('on error resume next \n');
	document.write('Sub Quiz_FSCommand(ByVal command, ByVal args)\n');
	document.write('  call Quiz_DoFSCommand(command, args)\n');
	document.write('end sub\n');
	document.write('</SCRIPT\> \n');
}
//-->
</SCRIPT>
<!-- URL's used in the movie-->
<!-- text used in the movie-->
<OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
 codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0"
 WIDTH="550" HEIGHT="400" id="Quiz" ALIGN="">
 <PARAM NAME=movie VALUE="Quiz.swf"> <PARAM NAME=quality VALUE=high> <PARAM NAME=bgcolor VALUE=#999999> <EMBED src="Quiz.swf" quality=high bgcolor=#999999  WIDTH="550" HEIGHT="400" NAME="Quiz" ALIGN=""
 TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED>
</OBJECT>
</BODY>
</HTML>
